{"version":3,"sources":["webpack:///./src/views/preview.vue?2a7d","webpack:///./src/views/preview.vue?22de","webpack:///src/views/preview.vue","webpack:///./src/views/preview.vue?c971","webpack:///./src/views/preview.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","style","staticStyle","attrs","on","returnToBase","staticRenderFns","components","name","data","componentList","currentStyle","screenStretch","screenDef","screenDefFlag","screenStretchFlag","backgroundStyleFlag","buttonBoxStyle","loadingInstance","loadingStatus","loadingDetail","stretch","background","stretchMethod","backgroundStyle","computed","watch","allStretch","resize","position","left","value","newVal","$nextTick","handler","deep","props","created","mounted","$loading","fullscreen","spinner","text","getScreenDef","getScreenStretch","getBackgroundStyle","getComponentList","window","addEventListener","beforeDestroy","removeEventListener","methods","$axios","url","method","templateID","$store","state","currentTemplateID","userID","currentUserID","width","designWindowWidth","height","designWindowHeight","transform","overflow","backgroundColor","backgroundImage","backgroundRepeat","backgroundSize","$router","push","mountTest","target","that","$refs","preview","mode","index","currentData","i","zindex","ifshow","top","deg","parentLimitation","preventActiveBehavior","dataSource","title","subTitle","draggable","resizable","active","component"],"mappings":"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","file":"js/preview.ff16a5a5.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./preview.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"preview\",staticClass:\"preview-wrapper\",style:(_vm.currentStyle)},[_c('div',{style:(_vm.buttonBoxStyle)},[_c('el-button',{staticStyle:{\"float\":\"right\"},attrs:{\"icon\":\"el-icon-close\",\"circle\":\"\"},on:{\"click\":_vm.returnToBase}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"preview-wrapper\" :style=\"currentStyle\" ref=\"preview\">\r\n    <div :style=\"buttonBoxStyle\">\r\n      <el-button style=\"float: right\" icon=\"el-icon-close\" @click=\"returnToBase\" circle></el-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n//通过该方法传字符串获取组件，使组件名与组件对应\r\nimport { getComponent } from '@components/visComponents/comMap.js'\r\n//由于在预览界面不会对子组件再进行操作，因此仅只引入mount方法，不保存整个Mount对象\r\nimport { mount } from 'vue-mount'\r\nimport url from '@mock/mockAPI.js'\r\n\r\nexport default {\r\n  components: {},\r\n  name: 'preview',\r\n  data() {\r\n    return {\r\n      componentList: [],\r\n      currentStyle: {},\r\n      screenStretch: {},\r\n      screenDef: [],\r\n      screenDefFlag: false,\r\n      screenStretchFlag: false,\r\n      backgroundStyleFlag: false,\r\n      buttonBoxStyle: {},\r\n      loadingInstance: null,\r\n      loadingStatus: false,\r\n      loadingDetail: {\r\n        components: false,\r\n        style: false,\r\n        stretch: false,\r\n        background: false\r\n      },\r\n      stretchMethod: '',\r\n      backgroundStyle: {}\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    screenStretchFlag: function(newVal) {\r\n      if (this.screenStretch.allStretch == true) {\r\n        this.stretchMethod = 'allStretch'\r\n      } else if (this.screenStretch.xStretch == true) {\r\n        this.stretchMethod = 'xStretch'\r\n      } else if (this.screenStretch.yStretch == true) {\r\n        this.stretchMethod = 'yStretch'\r\n      } else {\r\n        this.stretchMethod = 'noStretch'\r\n      }\r\n      if (this.screenStretchFlag == true && this.screenDefFlag == true && this.backgroundStyleFlag == true) {\r\n        this.resize()\r\n      }\r\n    },\r\n    screenDefFlag: function(newVal) {\r\n      this.buttonBoxStyle = {\r\n        position: 'absolute',\r\n        left: this.screenDef[0].value - 40 + 'px',\r\n        'z-index': 10000\r\n      }\r\n      if (this.screenStretchFlag == true && this.screenDefFlag == true && this.backgroundStyleFlag == true) {\r\n        this.resize()\r\n      }\r\n    },\r\n    backgroundStyleFlag: function(newVal) {\r\n      if (this.screenStretchFlag == true && this.screenDefFlag == true && this.backgroundStyleFlag == true) {\r\n        this.resize()\r\n      }\r\n    },\r\n    loadingStatus: function(newVal) {\r\n      if (newVal == true) {\r\n        this.$nextTick(() => {\r\n          this.loadingInstance.close()\r\n        })\r\n      }\r\n    },\r\n    loadingDetail: {\r\n      handler(newVal) {\r\n        if (newVal.components == true && newVal.style == true && newVal.stretch == true && newVal.background == true) {\r\n          this.loadingStatus = true\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  props: ['componentName'],\r\n  created() {},\r\n  mounted() {\r\n    this.loadingInstance = this.$loading({\r\n      fullscreen: true,\r\n      spinner: 'el-icon-loading',\r\n      background: 'rgba(0, 0, 0, 0.8)',\r\n      text: '正在加载中'\r\n    })\r\n    this.getScreenDef()\r\n    this.getScreenStretch()\r\n    this.getBackgroundStyle()\r\n    this.getComponentList()\r\n    window.addEventListener('resize', this.resize)\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener('resize', this.resize)\r\n  },\r\n\r\n  methods: {\r\n    getBackgroundStyle() {\r\n      this.$axios({\r\n        url: url.getBackgroundStyle,\r\n        method: 'post',\r\n        data: {\r\n          templateID: this.$store.state.currentTemplateID,\r\n          userID: this.$store.state.currentUserID\r\n        }\r\n      }).then(res => {\r\n        this.backgroundStyle = res.data\r\n        this.backgroundStyleFlag = true\r\n        this.loadingDetail.background = true\r\n      })\r\n    },\r\n    //获取缩放设置\r\n    getScreenStretch() {\r\n      this.$axios({\r\n        url: url.getScreenStretch,\r\n        method: 'post',\r\n        data: {\r\n          templateID: this.$store.state.currentTemplateID,\r\n          userID: this.$store.state.currentUserID\r\n        }\r\n      }).then(res => {\r\n        // console.log(res.data)\r\n        this.screenStretch = res.data\r\n        this.screenStretchFlag = true\r\n        this.loadingDetail.stretch = true\r\n      })\r\n    },\r\n    //获取屏幕设置\r\n    getScreenDef() {\r\n      this.$axios({\r\n        url: url.getScreenDef,\r\n        method: 'post',\r\n        data: {\r\n          templateID: this.$store.state.currentTemplateID,\r\n          userID: this.$store.state.currentUserID\r\n        }\r\n      }).then(res => {\r\n        console.log(res.data)\r\n        this.screenDef = res.data\r\n        this.screenDefFlag = true\r\n        this.loadingDetail.style = true\r\n        // this.$nextTick(() => {\r\n        //   this.loadingInstance.close()\r\n        // })\r\n      })\r\n    },\r\n    resize() {\r\n      let designWindowWidth = this.screenDef[0].value\r\n      let designWindowHeight = this.screenDef[1].value\r\n\r\n      switch (this.stretchMethod) {\r\n        case 'allStretch':\r\n          this.currentStyle = {\r\n            width: designWindowWidth + 'px',\r\n            height: designWindowHeight + 'px',\r\n            transform: `scale(${document.documentElement.clientWidth / designWindowWidth}, \r\n        ${document.documentElement.clientHeight / designWindowHeight}) translate(0px, 0px)`,\r\n            overflow: 'hidden',\r\n            backgroundColor: this.backgroundStyle.backgroundColor,\r\n            backgroundImage: `url('${this.backgroundStyle.backgroundImage}')`,\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundSize: '100% 100%'\r\n          }\r\n          break\r\n        case 'xStretch':\r\n          this.currentStyle = {\r\n            width: designWindowWidth + 'px',\r\n            height: designWindowHeight + 'px',\r\n            transform: `scale(${document.documentElement.clientWidth / designWindowWidth}, \r\n        ${1}) translate(0px, 0px)`,\r\n            'overflow-x': 'hidden',\r\n            backgroundColor: this.backgroundStyle.backgroundColor,\r\n            backgroundImage: `url('${this.backgroundStyle.backgroundImage}')`,\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundSize: '100% 100%'\r\n          }\r\n          break\r\n        case 'yStretch':\r\n          this.currentStyle = {\r\n            width: designWindowWidth + 'px',\r\n            height: designWindowHeight + 'px',\r\n            transform: `scale(${1}, \r\n        ${document.documentElement.clientHeight / designWindowHeight}) translate(0px, 0px)`,\r\n            'overflow-y': 'hidden',\r\n            backgroundColor: this.backgroundStyle.backgroundColor,\r\n            backgroundImage: `url('${this.backgroundStyle.backgroundImage}')`,\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundSize: '100% 100%'\r\n          }\r\n          break\r\n        case 'noStretch':\r\n          this.currentStyle = {\r\n            width: designWindowWidth + 'px',\r\n            height: designWindowHeight + 'px',\r\n            transform: `scale(${1}, \r\n        ${1}) translate(0px, 0px)`,\r\n            backgroundColor: this.backgroundStyle.backgroundColor,\r\n            backgroundImage: `url('${this.backgroundStyle.backgroundImage}')`,\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundSize: '100% 100%'\r\n          }\r\n          break\r\n      }\r\n    },\r\n    returnToBase() {\r\n      this.$router.push({ path: '/basePage' })\r\n    },\r\n    getComponentList() {\r\n      this.$axios({\r\n        url: url.getComponentList,\r\n        method: 'post',\r\n        data: {\r\n          templateID: this.$store.state.currentTemplateID\r\n        }\r\n      }).then(res => {\r\n        this.componentList = res.data.resultSet\r\n        this.mountTest()\r\n        this.loadingDetail.components = true\r\n      })\r\n    },\r\n    mountTest() {\r\n      let currentData = this.componentList\r\n      let that = this\r\n      for (let i = 0; i < currentData.length; i++) {\r\n        mount(getComponent(currentData[i].name), {\r\n          target: that.$refs.preview,\r\n          mode: 'append',\r\n          props: {},\r\n          data: {\r\n            index: currentData[i].index,\r\n            zindex: currentData[i].zindex,\r\n            target: this.$refs.target,\r\n            ifshow: currentData[i].ifshow,\r\n            width: currentData[i].width,\r\n            height: currentData[i].height,\r\n            top: currentData[i].top,\r\n            left: currentData[i].left,\r\n            deg: currentData[i].deg,\r\n            name: currentData[i].name,\r\n            parentLimitation: false,\r\n            preventActiveBehavior: true,\r\n            dataSource: currentData[i].dataSource,\r\n            title: currentData[i].title,\r\n            subTitle: currentData[i].subTitle,\r\n            style: currentData[i].style,\r\n            draggable: false,\r\n            resizable: false,\r\n            mode: 'preview',\r\n            active: false\r\n            // $store: this.$store\r\n            //重新挂载后无法访问到全局的this.$store,需要对$store重定向\r\n          },\r\n          on: {}\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.preview-wrapper {\r\n  transform-origin: 0 0;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./preview.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./preview.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./preview.vue?vue&type=template&id=9176b3be&\"\nimport script from \"./preview.vue?vue&type=script&lang=js&\"\nexport * from \"./preview.vue?vue&type=script&lang=js&\"\nimport style0 from \"./preview.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}